import{r as i,a as k,b as A,K as N,j as s,L as S}from"./index-BKybN0M0.js";import{L as w,R as I}from"./Leftbar-Cs3X_cKB.js";const L=()=>{const[c,x]=i.useState("daily"),[h,n]=i.useState({}),[j,l]=i.useState({});i.useState(!1),i.useState("");const o=k(),{data:u,loading:y,error:p}=A(e=>e.analysis),g=localStorage.getItem("userId");i.useEffect(()=>{o(N({range:c})),l({}),n({})},[o,g,c]);const d=(u==null?void 0:u.courses)||{},v=async e=>{n(a=>({...a,[e]:!0}));const t=d[e];if(!Array.isArray(t)){l(a=>({...a,[e]:"Veri yok"})),n(a=>({...a,[e]:!1}));return}const r=t.map(a=>({topic:a.name,correct:a.correct,wrong:a.wrong,duration:a.time}));try{const a=await o(S({analysisType:c,data:r})).unwrap(),m=Object.values(a).join(`

`);l(b=>({...b,[e]:m}))}catch{l(m=>({...m,[e]:"AI değerlendirme hatası."}))}n(a=>({...a,[e]:!1}))},f=e=>e?e.replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/\*(.+?)\*/g,"<em>$1</em>").replace(/^\s*[-•]\s+(.*)$/gm,"<li>$1</li>").replace(/(?:<li>.*<\/li>)/gs,"<ul>$&</ul>").replace(/\n{2,}/g,"<br/><br/>").replace(/\n/g,"<br/>"):"";return s.jsxs("div",{className:"analysis-wrapper",children:[s.jsx("div",{className:"analysis-tabs",children:["daily","weekly","monthly","overall"].map(e=>s.jsxs("button",{className:c===e?"active":"",onClick:()=>x(e),children:[e==="daily"&&"Günlük",e==="weekly"&&"Haftalık",e==="monthly"&&"Aylık",e==="overall"&&"Genel"]},e))}),!y&&!p&&s.jsx(s.Fragment,{children:s.jsxs("div",{className:"subject-list",children:[Object.keys(d).length===0&&s.jsx("p",{children:"Ders verisi bulunamadı."}),Object.keys(d).map(e=>{const t=d[e];return s.jsxs("div",{className:"subject-card",children:[s.jsxs("div",{className:"subject-info",children:[s.jsx("h4",{children:e}),Array.isArray(t)?t.map((r,a)=>s.jsxs("div",{className:"topic-box",children:[s.jsx("div",{className:"topic-name",children:r.name}),s.jsxs("div",{className:"topic-details",children:[s.jsxs("span",{children:["✅ ",r.correct]}),s.jsxs("span",{children:["❌ ",r.wrong]}),s.jsxs("span",{children:["⏱️ ",r.time," dk"]})]})]},a)):s.jsx("p",{children:"Geçerli konu verisi yok"})]}),s.jsxs("div",{className:"ai-section",children:[s.jsx("button",{className:"evaluate-btn",onClick:()=>v(e),disabled:h[e],children:h[e]?"Değerlendiriliyor...":"Yapay Zeka Değerlendir"}),j[e]&&s.jsx("div",{className:"ai-result-box",dangerouslySetInnerHTML:{__html:f(j[e])}})]})]},e)})]})})]})};function $(){return s.jsx("div",{className:"container-fluid analysis-page",children:s.jsxs("div",{className:"row",children:[s.jsx(w,{}),s.jsx("div",{className:"col-12 col-md-6 ",children:s.jsx(L,{})}),s.jsx(I,{})]})})}export{$ as default};
